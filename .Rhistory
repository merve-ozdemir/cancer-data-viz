lung_cancer_data <- data %>%
filter(Cancer_Type == "Lung", !is.na(Smoking_Status)) %>%
mutate(Smoking_Status = ifelse(Smoking_Status == "Never", "never", "smoker")) %>%
mutate(Smoking_Status = factor(Smoking_Status, levels = c("never", "smoker")))
plot_smoking_simplified <- ggplot(lung_cancer_data, aes(x = Cancer_Type, fill = Smoking_Status)) +
geom_bar(position = "dodge") +  # proportions within cancer type
labs(title = "Smoking Status Distribution by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Smoking Status") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#ggsave("plots/smoking_simplified.png", plot = plot_smoking_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_smoking
plot_smoking_simplified <- ggplot(lung_cancer_data, aes(x = Cancer_Type, fill = Smoking_Status)) +
geom_bar(position = "dodge") +  # proportions within cancer type
labs(title = "Smoking Status Distribution by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Smoking Status") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/smoking_simplified.png", plot = plot_smoking_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_smoking_simplified
smokers_simplified <- data %>% mutate(Smoking_Status = ifelse(Smoking_Status == "Never", "never", "smoker"))
plot_smoking_simplified <- ggplot(smokers_simplified, aes(x = Cancer_Type, fill = Smoking_Status)) +
geom_bar(position = "dodge") +  # proportions within cancer type
labs(title = "Smoking Status Distribution by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Smoking Status") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#ggsave("plots/smoking_simplified.png", plot = plot_smoking_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_smoking_simplified
smokers_simplified <- data %>% mutate(Smoking_Status = ifelse(Smoking_Status == "Never", "never", "smoker"))
plot_smoking_simplified <- ggplot(smokers_simplified, aes(x = Cancer_Type, fill = Smoking_Status)) +
geom_bar(position = "dodge") +  # proportions within cancer type
labs(title = "Smoking Status Distribution by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Smoking Status") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/smoking_simplified.png", plot = plot_smoking_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_smoking_simplified
plot_alcohol <- ggplot(data, aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol.png", plot = plot_alcohol, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol
alcohol_simplified <- data %>% mutate(Alcohol_Consumption = ifelse(Alcohol_Consumption == "none", "none", "drinker"))
plot_alcohol_simplified <- alcohol_simplified %>% ggplot(aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol_simplified.png", plot = plot_alcohol_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol_simplified
plot_alcohol <- ggplot(data, aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol.png", plot = plot_alcohol, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol
alcohol_simplified <- data %>% mutate(Alcohol_Consumption = ifelse(Alcohol_Consumption == "None", "none", "drinker"))
plot_alcohol_simplified <- alcohol_simplified %>% ggplot(aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol_simplified.png", plot = plot_alcohol_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol_simplified
plot_alcohol <- ggplot(data, aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol.png", plot = plot_alcohol, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol
alcohol_simplified <- data %>% mutate(Alcohol_Consumption = ifelse(Alcohol_Consumption == "None", "none", "drinker"), Alcohol_Consumption = factor(Alcohol_Consumption, levels = c("drinker", "none"))
)
plot_alcohol_simplified <- alcohol_simplified %>% ggplot(aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol_simplified.png", plot = plot_alcohol_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol_simplified
plot_alcohol <- ggplot(data, aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol.png", plot = plot_alcohol, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol
alcohol_simplified <- data %>% mutate(Alcohol_Consumption = ifelse(Alcohol_Consumption == "None", "none", "drinker"), Alcohol_Consumption = factor(Alcohol_Consumption, levels = c("none", "drinker"))
)
plot_alcohol_simplified <- alcohol_simplified %>% ggplot(aes(x = Cancer_Type, fill = Alcohol_Consumption)) +
geom_bar(position = "dodge") +
labs(title = "Alcohol Consumption by Cancer Type",
x = "Cancer Type",
y = "Count",
fill = "Alcohol Consumption") +
theme_minimal()
ggsave("plots/alcohol_simplified.png", plot = plot_alcohol_simplified, width = 8, height = 6, dpi = 300, bg = "white")
plot_alcohol_simplified
plot_family_history <- ggplot(data, aes(x = Cancer_Type, fill = Family_History)) + geom_bar(position = "fill") + labs(title = "Family History across Cancer Types", x = "Cancer Type", y = "Proportion", fill = "Family History") + theme_minimal()
ggsave("plots/family_history.png", plot = plot_family_history, width = 8, height = 6, dpi = 300, bg = "white")
plot_family_history
data %>% count(Treatment_Type)
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Cancer_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
labs(
title = "Distribution of Treatment Types Across Cancer Types",
x = "Cancer Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal()
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal()
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal()
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Cancer_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal()
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = NULL,
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(
axis.text.x = element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
coord_flip() +
labs(
title = "Treatment Types by Cancer Type",
x = NULL,  # removes axis title
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
data %>% count(Treatment_Type)
plot_treatment_by_cancer <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates one subplot for each cancer type!
labs(
title = "Treatment Types by Cancer Type",
x = "Treatment Type",
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/treatment.png", plot = plot_treatment_by_cancer, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_by_cancer
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
coord_flip() +
labs(
title = "Treatment Types by Cancer Type",
x = NULL,  # removes axis title
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
plot_treatment_facet
data %>% count(Treatment_Type)
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
coord_flip() +
labs(
title = "Treatment Types by Cancer Type",
x = NULL
y = "Count",
data %>% count(Treatment_Type)
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) +
coord_flip() +
labs(
title = "Treatment Types by Cancer Type",
x = NULL,
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
plot_treatment_facet
data %>% count(Treatment_Type)
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates a subplot for each cancer type
coord_flip() + #flipped coordinates bc labels are easier to read horizontally
labs(
title = "Treatment Types by Cancer Type",
x = NULL,
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
plot_treatment_facet
data %>% count(Treatment_Type)
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates a subplot for each cancer type
coord_flip() + #flipped coordinates bc labels are easier to read horizontally
labs(
title = "Treatment Types by Cancer Type",
x = NULL,
y = "Count",
fill = "Treatment Type"
) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
ggsave("plots/treatments.png", plot = plot_treatment_facet, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_facet
data %>% count(Treatment_Type)
plot_treatment_facet <- data %>%
ggplot(aes(x = Treatment_Type, fill = Treatment_Type)) +
geom_bar(position = "dodge") +
facet_wrap(~ Cancer_Type) + #facet_wrap creates a subplot for each cancer type
coord_flip() + #flipped coordinates bc labels are easier to read horizontally
labs(
title = "Treatment Types by Cancer Type",
x = NULL,
y = "Count",
fill = "Treatment Type"
) +
theme_minimal()
ggsave("plots/treatments.png", plot = plot_treatment_facet, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_facet
knitr::opts_chunk$set(echo = TRUE)
# Load required packages
library(tidyverse)
# Read the dataset (assumes file is in the same directory)
data <- read_csv("cancer_data_denmark.csv")
plot_treatment_vs_stage <- ggplot(data, aes(x = Stage, fill = Treatment_Type)) + geom_bar(position = "fill") + labs(title = "Types of Treatment for Each Cancer Stage", x = "Stage", y = "Proportion") + theme_minimal()
plot_treatment_vs_stage
plot_treatment_vs_stage <- ggplot(data, aes(x = Stage, fill = Treatment_Type)) + geom_bar(position = "fill") + labs(title = "Types of Treatment for Each Cancer Stage", x = "Stage", y = "Proportion") + theme_minimal()
plot_treatment_vs_stage
plot_treatment_vs_stage2 <- ggplot(data, aes(x = Treatment_Type, fill = Stage)) + geom_bar(position = "fill") + labs(title = "Types of Treatment for Each Cancer Stage", x = "Stage", y = "Proportion") + theme_minimal()
plot_treatment_vs_stage2
plot_treatment_per_stage
plot_treatment_per_stage <- ggplot(data, aes(x = Stage, fill = Treatment_Type)) + geom_bar(position = "fill") + labs(title = "Types of Treatment for Each Cancer Stage", x = "Stage", y = "Proportion") + theme_minimal()
ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_treatment_per_stage
plot_stage_per_treatment <- ggplot(data, aes(x = Treatment_Type, fill = Stage)) + geom_bar(position = "fill") + labs(title = "Types of Treatment for Each Cancer Stage", x = "Treatment", y = "Proportion") + theme_minimal()
ggsave("plots/stage_per_treatment.png", plot = plot_stage_per_treatment, width = 8, height = 6, dpi = 300, bg = "white")
plot_stage_per_treatment
View(data)
View(data)
plot_survival_vs_stage <- ggplot(data, aes(x = Stage, y = Survival_Months)) + geom_violin(fill = "skyblue", alpha = 0.5) + labs(title = "Survival in Different Stages of Cancer", x = "Stage", y = "Months Survival") + theme_minimal()
#ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_survival_vs_stage
plot_survival_vs_stage <- ggplot(data, aes(x = Stage, y = Survival_Months)) + geom_boxplot(fill = "skyblue", alpha = 0.5) + labs(title = "Survival in Different Stages of Cancer", x = "Stage", y = "Months Survival") + theme_minimal()
#ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_survival_vs_stage
plot_survival_vs_stage <- ggplot(data, aes(x = Stage, y = Treatment_Type)) + geom_boxplot(fill = "skyblue", alpha = 0.5) + labs(title = "Survival in Different Stages of Cancer", x = "Stage", y = "Months Survival") + theme_minimal()
#ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_survival_vs_stage
plot_survival_vs_stage <- ggplot(data, aes(x = Treatment_Type, y = Survival_Months)) + geom_boxplot(fill = "skyblue", alpha = 0.5) + labs(title = "Survival in Different Stages of Cancer", x = "Stage", y = "Months Survival") + theme_minimal()
#ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_survival_vs_stage
plot_survival_vs_stage <- ggplot(data, aes(x = Treatment_Type, y = Survival_Months)) + geom_bar(fill = "skyblue", alpha = 0.5) + labs(title = "Survival in Different Stages of Cancer", x = "Stage", y = "Months Survival") + theme_minimal()
#ggsave("plots/treatment_per_stage.png", plot = plot_treatment_per_stage, width = 8, height = 6, dpi = 300, bg = "white")
plot_survival_vs_stage
count(data, Genetic_Mutation)
plot_mutations <- ggplot(data, aes(x = Cancer_Type, fill = Genetic_Mutation)) + geom_bar(position = "dodge") + labs(title = "Genetic Mutations across Cancer Types", x = "Cancer Type", fill = "Genetic Mutation") + theme_minimal()
plot_mutations
brca_mutations <- data %>% filter(Genetic_Mutation == "BRCA1" | "BRCA2")
brca_mutations <- data %>% filter(Genetic_Mutation == "BRCA1" | "BRCA2")
brca_mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2"))
brca_mutations
brca_mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2"))
brca_mutations
plot_cancertype_with_brca <- brca_mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue") + labs(title = "Types of Cancers with BRCA1 or BRCA2 mutation", x = "Cancer Type", y = "Count") + theme_minimal()
plot_cancertype_with_brca
mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2", "TP53"))
mutations
plot_cancertype_with_mutation <- mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue") + labs(title = "Types of Cancers with mutations identified", x = "Cancer Type", y = "Count") + theme_minimal()
plot_cancertype_with_mutation
mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2", "TP53"))
mutations
plot_cancertype_with_mutation <- mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue") + coord_cartesian(ylim = c(100, 400)) + labs(title = "Types of Cancers with mutations identified", x = "Cancer Type", y = "Count") + theme_minimal()
plot_cancertype_with_mutation
mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2", "TP53"))
mutations
plot_cancertype_with_mutation <- mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue", width = 0.5) + coord_cartesian(ylim = c(200, 400)) + labs(title = "Types of Cancers with mutations identified", x = "Cancer Type", y = "Count") + theme_minimal()
plot_cancertype_with_mutation
plot_mutations <- ggplot(data, aes(x = Cancer_Type, fill = Genetic_Mutation)) + geom_bar(position = "dodge") + labs(title = "Genetic Mutations across Cancer Types", x = "Cancer Type", fill = "Genetic Mutation") + theme_minimal()
ggsave("plots/mutations.png", plot = plot_mutations, width = 8, height = 6, dpi = 300, bg = "white")
plot_mutations
mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2", "TP53"))
mutations
plot_cancertype_with_mutation <- mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue", width = 0.5) + coord_cartesian(ylim = c(200, 400)) + labs(title = "Types of Cancers with mutations identified", x = "Cancer Type", y = "Count") + theme_minimal()
ggsave("plots/cancertype_mutations.png", plot = plot_cancertype_with_mutations, width = 8, height = 6, dpi = 300, bg = "white")
mutations <- data %>% filter(Genetic_Mutation %in% c("BRCA1", "BRCA2", "TP53"))
mutations
plot_cancertype_with_mutation <- mutations %>% ggplot(aes(x = Cancer_Type)) + geom_bar(fill = "skyblue", width = 0.5) + coord_cartesian(ylim = c(200, 400)) + labs(title = "Types of Cancers with mutations identified", x = "Cancer Type", y = "Count") + theme_minimal()
ggsave("plots/cancertype_mutations.png", plot = plot_cancertype_with_mutation, width = 8, height = 6, dpi = 300, bg = "white")
plot_cancertype_with_mutation
plot_age <- ggplot(data, aes(x = Age)) +
geom_density(fill = "skyblue", color = "darkblue", alpha = 0.4) +
scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) +
labs(
title = "Age Distribution of Cancer Patients",
x = "Age",
y = "Density"
) +
theme_minimal()
ggsave("plots/age_distribution.png", plot = plot_age, width = 8, height = 6, dpi = 300, bg = "white")
plot_age
plot_age_vs_survival <- ggplot(data, aes(x = Age, y = Survival_Months)) + geom_density(fill = "skyblue", color = "darkblue", alpha = 0.4) + labs(title = "Survival by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
ggsave("plots/age_vs_survival.png", plot = plot_age_vs_survival, width = 8, height = 6, dpi = 300, bg = "white")
plot_age_vs_survival <- ggplot(data, aes(x = Age, y = Survival_Months)) + geom_density(fill = "skyblue", color = "darkblue", alpha = 0.4) +
scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) + labs(title = "Survival by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
ggsave("plots/age_vs_survival.png", plot = plot_age_vs_survival, width = 8, height = 6, dpi = 300, bg = "white")
plot_age_vs_survival <- ggplot(data, aes(x = Age, y = Survival_Months)) + geom_density(y = Survival_Months, fill = "skyblue", color = "darkblue", alpha = 0.4) +
scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) + labs(title = "Survival by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
plot_age_vs_survival <- ggplot(data, aes(x = Age)) + geom_density(fill = "skyblue", color = "darkblue", alpha = 0.4) +
scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) + labs(title = "Survival by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
ggsave("plots/age_vs_survival.png", plot = plot_age_vs_survival, width = 8, height = 6, dpi = 300, bg = "white")
plot_age_vs_survival
plot_age_vs_survival <- ggplot(data, aes(x = Age)) + geom_density(y = Survival_Months, fill = "skyblue", color = "darkblue", alpha = 0.4) +
scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) + labs(title = "Survival by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
plot_age_vs_survival <- ggplot(data, aes(x = Age, y = Survival_Months)) +
geom_point(alpha = 0.4, color = "steelblue") +
geom_smooth(method = "loess", se = TRUE, color = "darkred") +  # Optional trend line
labs(title = "Survival Months by Age",
x = "Age",
y = "Survival Months") +
theme_minimal()
ggsave("plots/age_vs_survival.png", plot = plot_age_vs_survival, width = 8, height = 6, dpi = 300, bg = "white")
plot_age_vs_survival
#First, filter the data to get a data frame with only lung cancer cases
lung_data <- data %>%
filter(Cancer_Type == "Lung") %>%
drop_na(Survival_Months)
#Next, select the columns/variables you want to keep as "predictors" of survival
lung_model_data <- lung_data %>%
select(Age, Gender, Cancer_Type, Stage, Smoking_Status, Alcohol_Consumption, BMI, Income_Level)
lung_model_data$Stage <- factor(lung_model_data$Stage, ordered = TRUE)
#training
set.seed(123)
train_indices <- sample(nrow(lung_model_data), 0.8 * nrow(lung_model_data))
train_data <- lung_model_data[train_indices, ]
test_data <- lung_model_data[-train_indices, ]
